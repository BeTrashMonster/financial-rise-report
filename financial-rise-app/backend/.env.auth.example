# =============================================================================
# Authentication Configuration
# =============================================================================
# This file contains the required environment variables for the authentication
# system. Copy this to .env and update with your secure values.

# -----------------------------------------------------------------------------
# JWT Configuration
# -----------------------------------------------------------------------------
# IMPORTANT: Use strong, random secrets in production!
# Generate secure secrets with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"

# Access Token Secret (used for short-lived access tokens)
JWT_SECRET=change-this-to-a-secure-random-secret-at-least-32-characters-long

# Refresh Token Secret (used for long-lived refresh tokens)
JWT_REFRESH_SECRET=change-this-to-a-different-secure-random-secret-at-least-32-characters-long

# Access Token Expiration (time format: 1h, 30m, 7d, etc.)
JWT_EXPIRATION=1h

# Access Token Expiration in Seconds (for API responses)
JWT_EXPIRATION_SECONDS=3600

# Refresh Token Expiration (time format: 1h, 30m, 7d, etc.)
JWT_REFRESH_EXPIRATION=7d

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_USER=financial_rise_user
DATABASE_PASSWORD=secure_database_password_here
DATABASE_NAME=financial_rise_db

# Database Connection Pool
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10

# -----------------------------------------------------------------------------
# Application Configuration
# -----------------------------------------------------------------------------
NODE_ENV=development
PORT=3000

# CORS Configuration
CORS_ORIGIN=http://localhost:3001

# -----------------------------------------------------------------------------
# Email Configuration (for password reset emails)
# -----------------------------------------------------------------------------
# TODO: Configure email service for password reset functionality
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=noreply@example.com
SMTP_PASSWORD=email_password_here
EMAIL_FROM=Financial RISE <noreply@example.com>

# -----------------------------------------------------------------------------
# Security Configuration
# -----------------------------------------------------------------------------
# Account Lockout Settings
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION_MINUTES=30

# Password Reset Token Expiration (in milliseconds)
PASSWORD_RESET_EXPIRATION_MS=3600000

# Bcrypt Salt Rounds (higher = more secure but slower)
BCRYPT_SALT_ROUNDS=12

# -----------------------------------------------------------------------------
# Rate Limiting (recommended for production)
# -----------------------------------------------------------------------------
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
LOG_LEVEL=debug
LOG_FORMAT=json

# =============================================================================
# Production Security Checklist
# =============================================================================
# [ ] Replace all secrets with cryptographically secure random values
# [ ] Set NODE_ENV=production
# [ ] Use HTTPS/TLS for all connections
# [ ] Configure proper CORS_ORIGIN
# [ ] Enable rate limiting
# [ ] Set up email service for password resets
# [ ] Configure database connection pooling
# [ ] Enable audit logging
# [ ] Review and test account lockout settings
# [ ] Implement IP-based rate limiting
# [ ] Configure monitoring and alerts
# =============================================================================
